<include file="left"/>
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="">
    <meta name="keywords" content="">
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1">
    -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="no-siteapp"/>
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Amaze UI"/>
    <meta name="msapplication-TileImage" content="assets/i/app-icon72x72@2x.png">
    <meta name="msapplication-TileColor" content="#0e90d2">
    <!-- <link rel="icon" sizes="192x192" href="assets/i/app-icon72x72@2x.png">
    -->
    <!-- <link rel="apple-touch-icon-precomposed" href="assets/i/app-icon72x72@2x.png">
    -->
    <!-- <link rel="icon" type="image/png" href="assets/i/favicon.png">
    -->
    <link rel="stylesheet" href="__PC__/css/normalize.css">
    <link rel="stylesheet" href="__PC__/css/bootstrap.min.css">
    <link rel="stylesheet" href="__PC__/css/bootstrap.offcanvas.min.css">

    <link rel="stylesheet" href="__PC__/css/font-awesome/font-awesome.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="__PC__/css/iframe.css">
    <title>考试系统</title>
</head>
<body>
        <!--[if lt IE 8]>
            <p class="browserupgrade">您正在使用一个 <strong>老旧的</strong> 浏览器. 为了您能获取更好的互联网体验，请 <a href="http://browsehappy.com.cn/" target="_blank">升级</a> 您的浏览器.</p>
            <![endif]-->

    <!-- =========================================== mycode =====================================- -->

    <div class="top">
        <img src="__PC__/img/logo.png" class="logo" alt="">
        <h1>导游考试模拟系统</h1>
        <!-- <div class="test-info">
            <div class="info">
                <span class="name">开始时间</span>
                00:00:00
            </div>
            <div class="info">
                <span class="name">结束时间</span>
                00:00:00
            </div>
            <div class="info">
                <span class="name zt">状态</span>
                未考
            </div>
            <div class="info">
                <span class="name">创建人员</span>
                XXX
            </div>
            <div class="time">
                11:11:11
            </div>
        </div> -->
        <div class="user">
            <p>您好,<php>echo $_SESSION['me']['realname']</php> <span class="exit"><a href="">退出</a></span></p>
        </div>
    </div>
    <div class="test">
        <div class="question question-on clearfix">
            <h3 class="question-title"></h3>
            <!-- <span class="question-tip ">
                <span class="question-num">1</span>/
                <span class="question-totalnum">30</span>
                <span class="question-icon"><i class="fa fa-lg fa-map-marker"></i></span>
            </span> -->
            <ul class="list-unstyled options">
            
            </ul>
            <div class="question-btns">
                <a  class="btn btn-prev prev">上一题</a>
                <a  class="btn btn-next next">下一题</a>
                <a  class="btn btn-question-submit push">提交</a>
            </div>
        </div>

        <div class="question-answer hide">
            <div class="question-tip-left">
                <h3>分析</h3>
            </div>
            <p class="answer-result"></p>
            <div class="question-tip-left">
                <h3>答案详解</h3>
            </div>
            <p class="answer-analysis"></p>
        </div>
    </div>
    <div class="right">
        <ul class="timus list-unstyled">
            <volist id="vo" name="question">
            <a class="num active" rel="{$vo.id}">
                {$key+1}
            </a>
            </volist>
        </ul>
        <!-- <div class="right-menu">
            <div class="show pull-left">
                <span class="s1">1</span>
                未答题
            </div>
            <div class="show pull-right">
                <span class="s3">3</span>
                已标记
            </div>
            <div class="show center-block">
                <span class="s2">2</span>
                已答题
            </div>
            <a  class="btn btn-submit">完成提交</a>
        </div> -->
    </div>



    <!-- ============================================ end =======================================- -->



<!--[if (gte IE 9)|!(IE)]>
<!-->
<!--<![endif]-->
<!--[if lte IE 8 ]>
<script src="http://cdn.staticfile.org/modernizr/2.8.3/modernizr.js"></script>
<script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
<script src="http://cdn.bootcss.com/html5shiv/r29/html5.min.js"></script>
<script src="assets/js/amazeui.ie8polyfill.min.js"></script>
<![endif]-->
    <script src="__PC__/js/jquery-1.9.1.min.js" ></script>
    <script src="__PC__/js/bootstrap.min.js"></script>
    <script src="__PC__/js/bootstrap.offcanvas.min.js"></script>
    <script src="__PC__/js/jquery.cookie.js"></script>
    <script>

    </script>
</body>
</html>
<include file="right"/>
<script>
	//初始化获取第一题
	ajaxGetQuestion({id:{$first_question.id}});
	$('.num:eq(0)').addClass('current');
	$(function(){
	//点击答题卡获取题
	$('.num').click(function(){
		$(this).addClass('current').siblings().removeClass('current');
		var sn = $(this).html();
		var id = $(this).attr('rel');
		var data = {id:id,sn:sn};
		ajaxGetQuestion(data);
		return false;
	});
	$(document).on('click','.next',function(){
		$(".question-answer").addClass('hide');
		moveQuestion('next');
	});
	$(document).on('click','.prev',function(){
		moveQuestion('prev');
	});
	//提交处理
	$(document).on('click','.push',function(){
		var input = $('input[rel="1"]');
		var checked = $('input:checked');
		var answer_true = false;
		if (input.length == checked.length) {
			answer_true = true;
			for(var i =0;i<input.length;i++){
				if ($(input[i]).val() != $(checked[i]).val()) {
					answer_true = false;
					break;
				}	
			}
		} 
		$('.question-answer').removeClass('hide');
		if (answer_true) {
			$('.answer-result').html('回答正确');
		} else {
			$('.answer-result').html('回答错误');
		}
	});
	});
/**
 * 移动题目 主要用于上一题 下一题
 * @param  string direction 方向 next prev
 * @return 
 */
function moveQuestion(direction){
	var current = $('.num.current');
	switch (direction) {
		case "prev":
		var current_direction = current.prev();
		
			break;
		case "next":
		var current_direction = current.next();
			break;
	}
	if (!(current_direction.length > 0)) {
		alert('没有啦');
		return false;
	}
	current_direction.addClass('current');
	current.removeClass('current');
	var id = current_direction.attr('rel');
	var sn = current_direction.html();
	var data = {id:id,sn:sn};
	ajaxGetQuestion(data);
}
/**
 * ajax 获取题目 并显示在页面上
 * @param  json data post数据
 * @return 
 */
function ajaxGetQuestion(data){
	$.ajax({
		type:"post",
		url:"/home/Practice/ajaxGetQuestion",
		data:data,
		datatype:"json",
		success:function(data){
			switch (data.question_info.question_type) {
				case '1':
					var type = '单选';
					var input_name = 'answer';
					var input_type = 'radio';
					break;
				case '2':
					var type = '多选';
					var input_name = 'answer[]';
					var input_type = 'checkbox';
					break;
			}
			//题目
			var title = data.question_info.sn+'.'+'('+type+')'+data.question_info.title;
			$('.question-title').html(title);
			//选项
			var stem = ''; 
			for(var i in data.question_info.question_stem){
				stem += '<li><input type="'+input_type+'" name="'+input_name+'" value="'+data.question_info.question_stem[i].sn+'" rel="'+data.question_info.question_stem[i].is_true+'">'+data.question_info.question_stem[i].stem_content+'</li>';
			}
			$('.options').html(stem);

			// str += '<div class="btnn"><span class="push btn">提交</span><span class="prev btn">上一题</span><span class="next btn">下一题</span></div><br/>';

			var analysis = data.question_info.explain;
			$('.answer-analysis').html(analysis);
		}
	});
}
	</script>